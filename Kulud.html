<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8"/>
  <title>Tarbimisstruktuur</title>

  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery.min.js"></script>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
  <!-- script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script -->
  <!-- script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

  <!-- Nova Mono font -->
  <link href="https://fonts.googleapis.com/css?family=Nova+Mono" rel="stylesheet"> 

  <!-- Stiilid ja skriptid -->
  <style>
    body {
      padding: 2rem;
      font-family: 'Nova Mono', monospace;
    }
    .diagramm { width: 800px; height: 500px; }
  </style>

  <!-- Google Charts Loader -->
  <script src="https://www.gstatic.com/charts/loader.js"></script>

  <script>

    var  c1 = ['#FFF59D', '#FFCC80', '#FFC107', '#FF9800', '#FF5722'];
    var  c2 = ['#90CAF9', '#80DEEA', '#03A9F4', '#00BCD4', '#009688'];
    var  c3 = ['#FAFAFA', '#F5F5F5', '#EEEEEE', '#E0E0E0', '#BDBDBD'];
    var  c4 = ['#ffcdd2', '#E1BEE7', '#f44336', '#E91E63', '#9C27B0'];
    // var colors = [ '#b30000', '#e34a33', '#fc8d59', '#fdcc8a', '#fef0d9' ];
    // var colors = [ '#FF8A65', '#FFD54F', '#FFF176', '#DCE775', '#80DEEA' ];
    // var colors = [ '#FFAB91', '#FFE082', '#E6EE9C', '#C8E6C9', '#B2DFDB' ];
    var pealkiri = { color: '#424242', fontName: 'Nova Mono', fontSize: 16, bold: false, italic: true };
    var legend = { color: '#424242', fontName: 'Nova Mono', fontSize: 24, bold: false, italic: false };

    function kujuta() {
      // Lae Google Charts
      google.charts.load('current');
      // Koosta diagrammid
      google.charts.setOnLoadCallback(koostaDiagrammid);
    }

    function koostaDiagrammid() {
      // Kategooriate lõikes
      var wrapperD1 = new google.visualization.ChartWrapper({
        chartType: 'PieChart',
        dataSourceUrl: 'https://docs.google.com/spreadsheets/d/1eWfIlscAOEc0mm8QJ3BYrsmR_9SWzUIfEfiLDVYxg0I/edit?sheet=Tabel1',
        query: 'SELECT A, B',
        options: { // 'title': 'Kategooriad',
          'colors': c1,
          'fontName': 'Nova Mono',
          'sliceVisibilityThreshold': .05,
          pieSliceBorderColor: 'Black',
          pieSliceTextStyle: { color: 'Black'},
          'titleTextStyle': pealkiri,
          legend: { textStyle: legend }
        },
        containerId: 'D1'
      });
      wrapperD1.draw();

      // Müüjate lõikes
      var wrapperD2 = new google.visualization.ChartWrapper({
        chartType: 'PieChart',
        dataSourceUrl: 'https://docs.google.com/spreadsheets/d/1eWfIlscAOEc0mm8QJ3BYrsmR_9SWzUIfEfiLDVYxg0I/edit?sheet=Tabel2',
        query: 'SELECT A, B',
        options: { // 'title': 'Müüjad',
          'colors': c2,
          'fontName': 'Nova Mono',
          'sliceVisibilityThreshold': .05,
          pieSliceBorderColor: 'Black',
          pieSliceTextStyle: { color: 'Black'},
          'titleTextStyle': pealkiri,
          legend: { textStyle: legend }
        },
        containerId: 'D2'
      });
      wrapperD2.draw();

      // Brändide lõikes
      var wrapperD3 = new google.visualization.ChartWrapper({
        chartType: 'PieChart',
        dataSourceUrl: 'https://docs.google.com/spreadsheets/d/1eWfIlscAOEc0mm8QJ3BYrsmR_9SWzUIfEfiLDVYxg0I/edit?sheet=Tabel3',
        query: 'SELECT A, B',
        options: { // 'title': 'Brändid',
          'colors': c3,
          'fontName': 'Nova Mono',
          'sliceVisibilityThreshold': .05,
          pieSliceBorderColor: 'Black',
          pieSliceTextStyle: { color: 'Black'},
          'titleTextStyle': pealkiri,
          legend: { textStyle: legend }
        },
        containerId: 'D3'
      });
      wrapperD3.draw();

      // Maade lõikes
      var wrapperD4 = new google.visualization.ChartWrapper({
        chartType: 'PieChart',
        dataSourceUrl: 'https://docs.google.com/spreadsheets/d/1eWfIlscAOEc0mm8QJ3BYrsmR_9SWzUIfEfiLDVYxg0I/edit?sheet=Tabel4',
        query: 'SELECT A, B',
        options: { // 'title': 'Maad',
          'colors': c4,
          'fontName': 'Nova Mono',
          'sliceVisibilityThreshold': .05,
          pieSliceBorderColor: 'Black',
          pieSliceTextStyle: { color: 'Black'},
          'titleTextStyle': pealkiri,
          legend: { textStyle: legend }
        },
        containerId: 'D4'
      });
      wrapperD4.draw();

    }

  </script>

  </head>

  <body onload="kujuta();">

  <div class='container'>
  <div class='row'>
  <div class='col-md-12'>

  <p>tehtud <a href='https://developers.google.com/chart/'>Google Charts</a>, <a href='http://colorbrewer2.org'>Color Brewer</a> ja Google Sheets abil | <a href='https://docs.google.com/spreadsheets/d/1eWfIlscAOEc0mm8QJ3BYrsmR_9SWzUIfEfiLDVYxg0I/edit?usp=sharing'>Andmed</a></p>

  <div id='D1' class='diagramm'></div>

  <div id='D2' class='diagramm'></div>

  <div id='D3' class='diagramm'></div>

  <div id='D4' class='diagramm'></div>

  </div>
  </div>
  </div>

  </body>

</html>